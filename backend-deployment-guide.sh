#!/bin/bash

echo "ğŸš€ Backend AWS Deployment Options"
echo "================================="
echo ""
echo "Your FastAPI backend can be deployed to AWS in several ways:"
echo ""

echo "ğŸ“‹ OPTION 1: AWS Lambda + Function URL (RECOMMENDED - Easiest)"
echo "   âœ… Pros: Serverless, auto-scaling, pay-per-request, simple setup"
echo "   âœ… Setup: One Terraform file, built-in CORS, direct HTTPS URL"
echo "   âš¡ Cost: ~\$0.20 per 1M requests (very cheap for development)"
echo "   ğŸš€ Deploy: terraform apply (uses lambda-simple.tf)"
echo ""

echo "ğŸ“‹ OPTION 2: AWS Lambda + API Gateway (More features)"
echo "   âœ… Pros: Advanced routing, request validation, rate limiting"
echo "   âš ï¸  Setup: More complex, requires API Gateway configuration"
echo "   ğŸš€ Deploy: terraform apply (uses lambda-api.tf)"
echo ""

echo "ğŸ“‹ OPTION 3: AWS ECS Fargate (Container-based)"
echo "   âœ… Pros: Full Docker support, better for complex apps"
echo "   âš ï¸  Cost: Always running (~\$15-30/month minimum)"
echo "   ğŸš€ Deploy: Requires Docker setup + ECS configuration"
echo ""

echo "ğŸ’¡ RECOMMENDATION: Start with Option 1 (Lambda + Function URL)"
echo "   - Easiest to set up and maintain"
echo "   - Perfect for your current application size"
echo "   - Can easily upgrade to API Gateway later if needed"
echo ""

echo "ğŸ› ï¸ NEXT STEPS:"
echo ""
echo "1ï¸âƒ£ Choose your deployment option"
echo ""
echo "2ï¸âƒ£ For Lambda deployment (Option 1 - Recommended):"
echo "   a) Install dependencies: pip install mangum boto3"
echo "   b) Run: ./deploy-backend-aws.sh"
echo "   c) This will:"
echo "      â€¢ Package your FastAPI app for Lambda"
echo "      â€¢ Deploy with Terraform"
echo "      â€¢ Update frontend to use AWS API URL"
echo "      â€¢ Redeploy frontend to S3"
echo ""
echo "3ï¸âƒ£ Alternative - Manual Lambda deployment:"
echo "   a) cd terraform"
echo "   b) Uncomment lambda-simple.tf resources"
echo "   c) terraform plan"
echo "   d) terraform apply"
echo "   e) Update frontend/.env.production with the output URL"
echo "   f) Rebuild and redeploy frontend"
echo ""

echo "ğŸ”§ Current Status:"
echo "   âœ… Infrastructure: Ready (S3 buckets deployed)"
echo "   âœ… Frontend: Deployed to AWS S3"
echo "   â³ Backend: Running locally (ready for AWS deployment)"
echo ""

echo "ğŸ“Š Expected Results After Backend Deployment:"
echo "   ğŸŒ Frontend: http://quickbite-blue.s3-website-us-east-1.amazonaws.com"
echo "   ğŸ”§ Backend: https://[random-id].lambda-url.us-east-1.on.aws/"
echo "   ğŸ“š API Docs: https://[random-id].lambda-url.us-east-1.on.aws/docs"
echo ""

echo "ğŸ’° Estimated AWS Costs (Lambda):"
echo "   Development usage: \$0-5/month"
echo "   Production usage: \$5-20/month (depending on traffic)"
echo ""

echo "ğŸ¯ Ready to deploy backend to AWS? Run:"
echo "   ./deploy-backend-aws.sh"
